$(function(){$("#pageCategory").hide();var a=[$("#header-title"),$("#url"),$("#nav-name")],c=$("input.menu-selector"),d=!$("#pageId").val(),b=$("#pageCategory").val();$("#optimized").val($("#toggle-optimized").attr("checked")?1:0);$(document).on("click",".template_name",function(){var a=$(this).parent().find('input[name="template-id"]').val();$("#templateId").val(a).change();$("#curr-template").text(a);$("#templatelist").hide("slide",{direction:"right"})}).on("click","input.menu-selector",function(a){checkMenu($(a.currentTarget).attr("id"),
b)}).on("click","#toggle-optimized",function(){var a=$(this),b=a.is(":checked")?1:0;b?toggleOptimized(b):showConfirm("Are you sure? You will lose experts optimization once you save your changes !",function(){toggleOptimized(b)},function(){a.prop("checked",!0)})}).on("click","#published",function(){var a=$("#draft");a.length&&a.val($(this).prop("checked")?0:1)}).on("blur","#datepicker",function(){$("#publish-at").val($(this).val())});d?($("#h1").keyup(function(){var b=$(this).val();$(a).each(function(){$(this).val(b);
$(this).removeClass("notvalid").removeAttr("title")})}),c.each(function(){$(this).attr("checked",!1)})):checkMenu()});
function toggleOptimized(a){$("#optimized").val(a);$.post($("#website_url").val()+"backend/backend_page/toggleoptimized/",{pid:$("#pageId").val(),optimized:a},function(c){$.each(c.data,function(c,b){var e=$("[name="+c+"]",$("#frm-page"));e.val(b);a?e.attr("disabled",!0).attr("readonly","readonly").addClass("noedit"):e.removeAttr("disabled").removeAttr("readonly").removeClass("noedit")})},"json")}function datepickerCallback(){$("#publish-at").val($(this).val())}
function checkMenu(a,c){var d=$("#pageId").val(),b=$("#pageCategory");$("#website_url").val();"undefined"!=typeof a&&a||(a=$(".menu-selector:checked").attr("id"));switch(a){case "inMenu-2":$(".menu-info").show().text("This page is in flat menu");case "inMenu-0":b.find('option[value="-1"]').length||b.prepend($("<option />").val("-1").text("No category"));b.val(-1);b.hide();"inMenu-0"==a&&$(".menu-info").show().text("This page is not in menu");break;case "inMenu-1":b.find('option[value="-1"]').remove(),
d?"undefined"!=typeof c&&b.val(c):b.val(-4),b.show().next(".menu-info").hide()}}
function showTemplatesList(){var a=$("#templatelist");$.post($("#website_url").val()+"backend/backend_theme/gettemplate/pageId/"+$("#pageId").val(),{listtemplates:"all",beforeSend:showSpinner("#templatelist")},function(c){a.html(c).find(".content").accordion({heightStyle:"content",header:".template_header",collapsible:!0,icons:{header:"icon-arrow-right",activeHeader:"icon-arrow-down"}});a.find(".template_group").css({"max-height":a.find(".content").height()-a.find(".template_header:last").outerHeight(!0)*
a.find(".template_header").length});hideSpinner()})};
