$(function(){var a=decodeURI(window.location.href);if(a&&"undefined"!=typeof a){var b=$("a[href='"+a+"']");b.addClass("current");b.closest(".page").length&&b.closest(".category").addClass("current");a==$("#website_url").val()&&$("a[href='"+$("#website_url").val()+"index.html']").addClass("current")}$(document).on("click","a.tpopup",function(a){if(loginCheck()){$(".__tpopup").dialog("close");a.preventDefault();var d=$(this);a=d.data("pwidth")||960;var c=d.data("pheight")||560,b=$(document.createElement("iframe")).attr({scrolling:"no",
frameborder:"no",allowTransparency:"allowTransparency",id:"toasterPopup"}).addClass("__tpopup");b.parent().css({background:"none"});b.dialog({width:a,height:c,resizable:!1,draggable:!0,modal:!0,open:function(){this.onload=function(){$(this).contents().find(".close, .save-and-close").on("click",function(){null!==localStorage.getItem(generateStorageKey())?showConfirm("Hey, you did not save your work? Are you sure you want discard all changes?",function(){localStorage.removeItem(generateStorageKey());
closePopup(b)}):closePopup(b)})};$(this).attr("src",d.data("url")).css({width:"100%",height:"100%",padding:"0px",margin:"0px",overflow:"hidden"});$('[aria-describedby="toasterPopup"] .ui-dialog-titlebar').remove()},close:function(){$(this).remove()}}).parent().css({height:c+"px"})}});$(document).on("click","a._tdelete",function(){var a=this,d=$(this).attr("href"),c=$(this).data("callback"),b=$(this).data("eid");"undefined"!=typeof d&&d&&"javascript:;"!=d||(d=$(this).data("url"));smoke.confirm("You are about to remove an item. Are you sure?",
function(g){g?$.post(d,{id:b,beforeSend:showSpinner(a)},function(a){var b=a.hasOwnProperty(b)?a.responseText:"Removed.";showMessage(b,!("undefined"==typeof a.error||!a.error));"undefined"!=typeof c&&eval(c+"()");hideSpinner()}):$(".smoke-base").remove()},{classname:"error",ok:"Yes",cancel:"No"})});$(document).on("submit","form._fajax",function(a){a.preventDefault();var b=$(this),c=$(b).data("callback");$.ajax({url:b.attr("action"),type:"post",dataType:"json",data:b.serialize(),beforeSend:showSpinner(),
success:function(a){a.error?(hideSpinner(),"object"===typeof a.responseText?($.each(a.responseText,function(a,c){var e=b.find('[name="'+a+'"]');e.addClass("notvalid");e.is(":checkbox")||e.is(":radio")||e.is(":hidden")?e.parent().is("label")?e.parent().prop("title",c).addClass("notvalid"):(e=e.prop("id"),$(document).find('[for="'+e+'"]').prop("title",c).addClass("notvalid")):e.prop("title",c)}),$(".notvalid").on("change",function(){var a=$(this);if(a.is(":checkbox")||a.is(":radio")||a.is(":hidden"))if(a.parent().is("label"))a.parent().tooltip("destroy").removeAttr("title",
"").removeClass("notvalid");else{var b=a.prop("id");$(document).find('[for="'+b+'"]').tooltip("destroy").removeAttr("title","").removeClass("notvalid")}else a.tooltip("destroy").removeClass("notvalid").removeAttr("title");a.unbind()}),showTooltip(".notvalid","error","right")):smoke.alert(a.responseText,function(){"undefined"!=typeof c&&null!=c&&eval(c+"()")},{classname:"error"})):b.hasClass("_reload")?"undefined"!=typeof a.responseText.redirectTo?top.location.href=$("#website_url").val()+a.responseText.redirectTo:
top.location.reload():("undefined"!=typeof c&&null!=c&&eval(c+"()"),hideSpinner(),showMessage(a.responseText))},error:function(a){$(".smoke-base").remove();showMessage("Oops! sorry but something fishy is going on - try again or call for support.",!0)}})});$(document).on("click","a._tedit",function(a){a.preventDefault();(a=$(this).data("url"))&&"undefined"!=a||(a=$(this).attr("href"));var b=$(this).data("eid");$.post(a,{id:b},function(a){$("#"+a.responseText.formId);for(var b in a.responseText.data)$("[name="+
b+"]").val(a.responseText.data[b]),"password"==b&&$("[name="+b+"]").val("")})});jQuery.fancybox&&$("a._lbox").fancybox({transitionIn:"none",transitionOut:"none",titlePosition:"over"});checkboxRadioStyle();$(document).on("click",".closebutton .hide-block",function(){$(".show-left").hide("slide",{direction:"left"});$(".show-right").hide("slide",{direction:"right"});return!1});$(document).ajaxStop(function(){hideSpinner();checkboxRadioStyle()})});
$(document).on("click",".screen-size",function(a){a=$(this).data("size");$(".closebutton").toggle();$(this).toggleClass("ticon-expand ticon-turn");$("body, #"+a+", ."+a).toggleClass("full-screen")});
$(document).on("click","#screen-expand",function(a){$(this).toggleClass("ticon-expand ticon-turn");a=$(window.parent.document).find('[aria-describedby="toasterPopup"]');a.toggleClass("screen-expand");$(".content").toggleClass("screen-expand");a=a.height();$("#edittemplate").length?$(".ace_editor").height(a-170):$(".ace_editor").height(a-110);editor.resize()});
function showTooltip(a,b,e){$(a+"[title]").tooltip();var d="",c="";switch(e){case "right":d="left+10 center";c="right center";break;case "left":d="right-10 center";c="left center";break;case "top":d="center bottom-10";c="center top";break;case "bottom":d="center top+10",c="center bottom"}$(a+"[title]").tooltip("option",{tooltipClass:b,position:{my:d,at:c,using:function(a,b){$(this).css(a);$("<span>").addClass("arrow").addClass(b.vertical).addClass(b.horizontal).appendTo(this)}}})}
$(document).on("click",'[name="useImage"]:checkbox',function(){var a=$(this).closest("form"),b=a.find(".cropped-img");b.fadeToggle(function(){b.is(":visible")||b.find("input:checkbox").prop("checked",!1)});a.find(".crop-size").hide().find("input:text").val("")});$(document).on("click",".cropped-img input:checkbox",function(){var a=$(this).closest("form").find(".crop-size");a.fadeToggle(function(){a.is(":visible")||a.find("input:text").val("")})});
$(document).on("click",".tabs-nav-wrap .arrow",function(){var a=$(this).nextAll(".ui-tabs-nav"),b=a.scrollLeft();$(this).hasClass("left")?a.stop().animate({scrollLeft:b-200}):$(this).hasClass("right")&&a.stop().animate({scrollLeft:b+200})});
function checkboxRadioStyle(){$(".seotoaster").length&&!$(".ie8").length&&$("input:checkbox, input:radio",".seotoaster").not(".processed, .icon, .hidden").each(function(){var a=$(this).prop("id");a.length||(a="chr-"+Math.floor(1E5*Math.random()+1),$(this).prop("id",a));$(this).is(":radio")?$(this).addClass("radio-upgrade filed-upgrade"):$(this).addClass("checkbox-upgrade filed-upgrade");if(!$(this).closest(".btn-set").length){var b=$(this).parent("label");b.length?(b.prop("for",a),$(this).hasClass("switcher")?
$(this).after('<span class="checkbox_radio"><span></span></span>'):$(this).after('<span class="checkbox_radio"></span>')):$(this).hasClass("switcher")?$(this).wrap('<label class="checkbox_radio-wrap"></label>').after('<span class="checkbox_radio"><span></span></span>'):$(this).wrap('<label for="'+a+'" class="checkbox_radio-wrap"></label>').after('<span class="checkbox_radio"></span>')}$(this).addClass("processed")})}
function loginCheck(){return null===$.cookie("PHPSESSID")?(showModalMessage("Session expired","Your session is expired! Please, login again",function(){top.location.href=$("#website_url").val()}),!1):!0}function showMessage(a,b,e){b?smoke.alert(a,function(a){},{classname:"error"}):(smoke.signal(a),e="undefined"==typeof e?1300:e,$(".smoke-base").delay(e).slideUp())}
function showConfirm(a,b,e){smoke.confirm(a,function(a){a?"undefined"!=typeof b&&b():"undefined"!=typeof e&&e()},{classname:"error",ok:"Yes",cancel:"No"})}function showSpinner(a){$("undefined"!==typeof a?a:"body>.seotoaster").append('<span class="spinner"></span>')}function hideSpinner(){$(".spinner").remove()}function showLoader(a){$(event.target).addClass("btn-load").attr("disabled","true");a="undefined"===typeof a?"Loading...":a;$("body").append('<div class="seotoaster-loader">'+a+"</div>")}
function hideLoader(a){$(".btn-load").removeClass("btn-load").removeAttr("disabled","false");$(".seotoaster-loader").remove()}function publishPages(){top.$("#__tpopup").length||$.get($("#website_url").val()+"backend/backend_page/publishpages/")}function closePopup(a){a.contents().find("div.seotoaster").hasClass("refreshOnClose")&&window.parent.location.reload();"undefined"!=typeof a.dialog?a.dialog("close"):console.log("Alarm! Something went wrong!")}
function generateStorageKey(){if($("#frm_content").length){var a=$("#frm_content").prop("action").split("/");return a[5]+a[7]+("undefined"==typeof a[9]?$("#page_id").val():a[9])}return null}
function showMailMessageEdit(a,b){$.getJSON($("#website_url").val()+"backend/backend_config/mailmessage/",{trigger:a},function(a){$(d).remove();var d=$('<div class="msg-edit-screen"></div>').append($('<textarea id="trigger-msg" rows="10"></textarea>').val(a.responseText).css({resizable:"none"}));$("#trigger-msg").val(a.responseText);d.dialog({modal:!0,title:"Edit mail message before sending",width:600,resizable:!1,show:"clip",hide:"clip",draggable:!1,buttons:[{text:"Okay",click:function(a){d.dialog("close");
b($("#trigger-msg").val())}}]})},"json")}document.onkeydown=khandle;function khandle(a){a=a||event;75==a.keyCode&&(a.ctrlKey&&a.altKey&&!a.shiftKey)&&$("#seotoaster-cpanel").toggle();75==a.keyCode&&(a.ctrlKey&&a.altKey&&a.shiftKey)&&$(".generator-links, .tpopup, .form-controls").toggle()}
function addGeneralLinks(a,b,e,d){var c=$("#website_url").val(),h=$("#page_id").val(),g=window.location.href.replace(c,""),k=$(".generator-links").length,f=$('<a class="tpopup generator-links" href="javascript:;"></a>'),g={page:g,pid:h,type:b,name:a,action:"index",controller:"index",co:"index"};switch(b){case 1:f.append('<img width="26" height="26" src="'+c+'system/images/editadd-content.png" alt="edit content"/>').attr({"data-pheight":560,"data-pwidth":960,title:"Click to edit content"});break;case 2:f.append('<img width="26" height="26" src="'+
c+'system/images/editadd-static-content.png" alt="edit static content"/>').attr({"data-pheight":560,"data-pwidth":960,title:"Click to edit static content"});break;case 3:f.append('<img width="26" height="26" src="'+c+'system/images/editadd-header.png" alt="edit header"/>').attr({"data-pheight":140,"data-pwidth":600,title:"Click to edit header"});break;case 4:f.append('<img width="26" height="26" src="'+c+'system/images/editadd-static-header.png" alt="edit static header"/>').attr({"data-pheight":140,
"data-pwidth":600,title:"Click to edit static header"});break;case 5:f.append('<img width="26" height="26" src="'+c+'system/images/editadd-code.png" alt="edit static header"/>').attr({"data-pheight":560,"data-pwidth":960,title:"Click to edit code"});break;default:return!1}$.ajax({url:c+"api/toaster/containers/",type:"get",data:g,async:!1,success:function(d){if("undefined"!==typeof d)if(0!=k&&!e)0<d[a].length?f.attr({"data-url":c+"backend/backend_content/edit/name/"+a+"/containerType/"+b+"/pageId/"+
h}):f.attr({"data-url":c+"backend/backend_content/add/containerType/"+b+"/containerName/"+a+"/pageId/"+h}),$content=d[a]+f[0].outerHTML;else if(0==k||e)$content=d[a]}});d&&"function"===typeof d&&d(f,c,g);return $content};
