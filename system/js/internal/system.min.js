var doc=$(document);
$(function(){var a=decodeURI(window.location.href);a&&"undefined"!=typeof a&&($("a[href='"+a+"']").addClass("current"),a==$("#website_url").val()&&$("a[href='"+$("#website_url").val()+"index.html']").addClass("current"));doc.on("click","a.tpopup",function(a){if(loginCheck()){$(".__tpopup").dialog("close");a.preventDefault();var c=$(this);a=c.data("pwidth")||960;var d=c.data("pheight")||560,b=$(document.createElement("iframe")).attr({scrolling:"no",frameborder:"no",allowTransparency:"allowTransparency",id:"toasterPopup"}).addClass("__tpopup");
b.parent().css({background:"none"});b.dialog({width:a,height:d,resizable:!1,draggable:!0,modal:!0,open:function(){this.onload=function(){$(this).contents().find(".close, .save-and-close").on("click",function(){null!==localStorage.getItem(generateStorageKey())?showConfirm("Hey, you did not save your work? Are you sure you want discard all changes?",function(){localStorage.removeItem(generateStorageKey());closePopup(b)}):closePopup(b)})};$(this).attr("src",c.data("url")).css({width:"100%",height:"100%",
padding:"0px",margin:"0px",overflow:"hidden"});$('[aria-describedby="toasterPopup"] .ui-dialog-titlebar').remove()},close:function(){$(this).remove()}}).parent().css({height:d+"px"})}});doc.on("click","a._tdelete",function(){var a=this,c=$(this).attr("href"),d=$(this).data("callback"),b=$(this).data("eid");"undefined"!=typeof c&&c&&"javascript:;"!=c||(c=$(this).data("url"));smoke.confirm("You are about to remove an item. Are you sure?",function(f){f?$.post(c,{id:b,beforeSend:showSpinner(a)},function(a){var b=
a.hasOwnProperty(b)?a.responseText:"Removed.";showMessage(b,!("undefined"==typeof a.error||!a.error));"undefined"!=typeof d&&eval(d+"()");hideSpinner()}):$(".smoke-base").remove()},{classname:"error",ok:"Yes",cancel:"No"})});doc.on("submit","form._fajax",function(a){a.preventDefault();var c=$(this),d=$(c).data("callback");$.ajax({url:c.attr("action"),type:"post",dataType:"json",data:c.serialize(),beforeSend:showSpinner(),success:function(a){a.error?(hideSpinner(),"object"===typeof a.responseText?
($.each(a.responseText,function(a,d){var b=c.find('[name="'+a+'"]');b.addClass("notvalid");b.is(":checkbox")||b.is(":radio")||b.is(":hidden")?b.parent().is("label")?b.parent().prop("title",d).addClass("notvalid"):(b=b.prop("id"),doc.find('[for="'+b+'"]').prop("title",d).addClass("notvalid")):b.prop("title",d)}),$(".notvalid").on("change",function(){var a=$(this);if(a.is(":checkbox")||a.is(":radio")||a.is(":hidden"))if(a.parent().is("label"))a.parent().tooltip("destroy").removeAttr("title","").removeClass("notvalid");
else{var b=a.prop("id");doc.find('[for="'+b+'"]').tooltip("destroy").removeAttr("title","").removeClass("notvalid")}else a.tooltip("destroy").removeClass("notvalid").removeAttr("title");a.unbind()}),showTooltip(".notvalid","error","right")):smoke.alert(a.responseText,function(){"undefined"!=typeof d&&null!=d&&eval(d+"()")},{classname:"error"})):c.hasClass("_reload")?"undefined"!=typeof a.responseText.redirectTo?top.location.href=$("#website_url").val()+a.responseText.redirectTo:top.location.reload():
("undefined"!=typeof d&&null!=d&&eval(d+"()"),hideSpinner(),showMessage(a.responseText))},error:function(a){$(".smoke-base").remove();showMessage("Oops! sorry but something fishy is going on - try again or call for support.",!0)}})});doc.on("click","a._tedit",function(a){a.preventDefault();(a=$(this).data("url"))&&"undefined"!=a||(a=$(this).attr("href"));var c=$(this).data("eid");$.post(a,{id:c},function(a){$("#"+a.responseText.formId);for(var b in a.responseText.data)$("[name="+b+"]").val(a.responseText.data[b]),
"password"==b&&$("[name="+b+"]").val("")})});jQuery.fancybox&&$("a._lbox").fancybox({transitionIn:"none",transitionOut:"none",titlePosition:"over"});checkboxRadio();doc.on("click",".closebutton .hide",function(){$(".show-left.show, .show-right.show").removeClass("show");return!1})});doc.on("click",".screen-size",function(a){a=$(this).data("size");$(".closebutton").toggleClass("hidden");$(this).toggleClass("icon-expand icon-turn").toggleClass("inverse-info inverse-error");$("#"+a+", ."+a).toggleClass("full-screen")});
doc.on("click","#screen-expand",function(a){$(this).toggleClass("icon-expand icon-turn");a=$(window.parent.document).find('[aria-describedby="toasterPopup"]');a.toggleClass("screen-expand");$(".content").toggleClass("screen-expand");a=a.height();$("#edittemplate").length?$(".ace_editor").height(a-170):$(".ace_editor").height(a-110);editor.resize()});
function showTooltip(a,e,c){$(a+"[title]").tooltip();switch(c){case "right":$(a+"[title]").tooltip("option",{tooltipClass:e,position:{my:"left+10 center",at:"right center",using:function(a,b){$(this).css(a);$("<span>").addClass("arrow").addClass(b.vertical).addClass(b.horizontal).appendTo(this)}}});break;case "left":$(a+"[title]").tooltip("option",{tooltipClass:e,position:{my:"right-10 center",at:"left center",using:function(a,b){$(this).css(a);$("<span>").addClass("arrow").addClass(b.vertical).addClass(b.horizontal).appendTo(this)}}});
break;case "top":$(a+"[title]").tooltip("option",{tooltipClass:e,position:{my:"center bottom-10",at:"center top",using:function(a,b){$(this).css(a);$("<span>").addClass("arrow").addClass(b.vertical).addClass(b.horizontal).appendTo(this)}}});break;case "bottom":$(a+"[title]").tooltip("option",{tooltipClass:e,position:{my:"center top+10",at:"center bottom",using:function(a,b){$(this).css(a);$("<span>").addClass("arrow").addClass(b.vertical).addClass(b.horizontal).appendTo(this)}}})}}
doc.on("click",'[name="useImage"]',function(){$(this).closest("form").find(".cropped-img").fadeToggle()});doc.on("click",".tabs-nav-wrap .arrow",function(){var a=$(this).nextAll(".ui-tabs-nav"),e=a.scrollLeft();$(this).hasClass("left")?a.animate({scrollLeft:e-200}):$(this).hasClass("right")&&a.animate({scrollLeft:e+200})});
function checkboxRadio(){$("input:checkbox, input:radio").not(".processed, .icon, .hidden").each(function(){$(this).closest(".btn-set").length||($(this).parent("label").length?$(this).hasClass("switcher")?$(this).after('<span class="checkbox_radio"><span></span></span>'):$(this).after('<span class="checkbox_radio"></span>'):$(this).hasClass("switcher")?$(this).wrap('<label class="checkbox_radio-wrap '+$(this).data("label-class")+'"></label>').after('<span class="checkbox_radio"><span></span></span>'):
$(this).wrap('<label class="checkbox_radio-wrap '+$(this).data("label-class")+'"></label>').after('<span class="checkbox_radio"></span>'));$(this).addClass("processed")})}function loginCheck(){return null===$.cookie("PHPSESSID")?(showModalMessage("Session expired","Your session is expired! Please, login again",function(){top.location.href=$("#website_url").val()}),!1):!0}
function showMessage(a,e,c){e?smoke.alert(a,function(a){},{classname:"error"}):(smoke.signal(a),c="undefined"==typeof c?1300:c,$(".smoke-base").delay(c).slideUp())}function showConfirm(a,e,c){smoke.confirm(a,function(a){a?"undefined"!=typeof e&&e():"undefined"!=typeof c&&c()},{classname:"error",ok:"Yes",cancel:"No"})}function showSpinner(a){$("undefined"!==typeof a?a:"body>.seotoaster").append('<span class="spinner"></span>')}function hideSpinner(){$(".spinner").remove()}
function publishPages(){top.$("#__tpopup").length||$.get($("#website_url").val()+"backend/backend_page/publishpages/")}function closePopup(a){a.contents().find("div.seotoaster").hasClass("refreshOnClose")&&window.parent.location.reload();"undefined"!=typeof a.dialog?a.dialog("close"):console.log("Alarm! Something went wrong!")}
function generateStorageKey(){if($("#frm_content").length){var a=$("#frm_content").prop("action").split("/");return a[5]+a[7]+("undefined"==typeof a[9]?$("#page_id").val():a[9])}return null}
function showMailMessageEdit(a,e){$.getJSON($("#website_url").val()+"backend/backend_config/mailmessage/",{trigger:a},function(a){$(d).remove();var d=$('<div class="msg-edit-screen"></div>').append($('<textarea id="trigger-msg"></textarea>').val(a.responseText).css({width:"555px",height:"155px",resizable:"none"}));$("#trigger-msg").val(a.responseText);d.dialog({modal:!0,title:"Edit mail message before sending",width:600,height:300,resizable:!1,show:"clip",hide:"clip",draggable:!1,buttons:[{text:"Okay",
click:function(a){d.dialog("close");e($("#trigger-msg").val())}}]}).parent().css({background:"#DAE8ED"})},"json")};
