$(function(){var a=decodeURI(window.location.href);a&&"undefined"!=typeof a&&($("a[href='"+a+"']").addClass("current"),a==$("#website_url").val()&&$("a[href='"+$("#website_url").val()+"index.html']").addClass("current"));$(document).on("click","a.tpopup",function(d){if(loginCheck()){d.preventDefault();var b=$(this),c=b.data("pwidth")||960,a=b.data("pheight")||580,f=$(document.createElement("iframe")).attr({scrolling:"no",frameborder:"no",allowTransparency:"allowTransparency",id:"toasterPopup"}).addClass("__tpopup rounded3px");
    f.parent().css({background:"none"});f.dialog({width:c,height:a,resizable:!1,draggable:!0,modal:!0,open:function(){this.onload=function(){$(this).contents().find(".close, .save-and-close").on("click",function(){null!==localStorage.getItem(generateStorageKey())?showConfirm("Hey, you did not save your work? Are you sure you want discard all changes?",function(){localStorage.removeItem(generateStorageKey());closePopup(f)}):closePopup(f)})};$(this).attr("src",b.data("url")).css({width:c+"px",height:a+
        "px",padding:"0px",margin:"0px",overflow:"hidden"});$('[aria-describedby="toasterPopup"] .ui-dialog-titlebar').remove()},close:function(){$(this).remove()}})}});$(document).on("click","a._tdelete",function(){var a=$(this).attr("href"),b=$(this).data("callback"),c=$(this).data("eid");"undefined"!=typeof a&&a&&"javascript:;"!=a||(a=$(this).data("url"));smoke.confirm("You are about to remove an item. Are you sure?",function(e){e?$.post(a,{id:c},function(a){var c=a.hasOwnProperty(c)?a.responseText:"Removed.";showMessage(c,!("undefined"==
    typeof a.error||!a.error));"undefined"!=typeof b&&eval(b+"()")}):$(".smoke-base").remove()},{classname:"errors",ok:"Yes",cancel:"No"})});$(document).on("submit","form._fajax",function(a){a.preventDefault();var b="#h1 #header-title #url #nav-name #meta-description #meta-keywords #teaser-text".split(" "),c=$(this),e=$(c).data("callback");$.ajax({url:c.attr("action"),type:"post",dataType:"json",data:c.serialize(),beforeSend:function(){showSpinner()},success:function(a){a.error?($(c).data("norefresh")||
    $(c).find("input:text").not(b.join(",")).val(""),hideSpinner(),smoke.alert(a.responseText,{classname:"errors"},function(){"undefined"!=typeof e&&null!=e&&eval(e+"()")})):c.hasClass("_reload")?"undefined"!=typeof a.responseText.redirectTo?top.location.href=$("#website_url").val()+a.responseText.redirectTo:top.location.reload():("undefined"!=typeof e&&null!=e&&eval(e+"()"),hideSpinner(),showMessage(a.responseText))},error:function(a){$(".smoke-base").remove();showMessage("Oops! sorry but something fishy is going on - try again or call for support.",
    !0)}})});$(document).on("click","a._tedit",function(a){a.preventDefault();(a=$(this).data("url"))&&"undefined"!=a||(a=$(this).attr("href"));var b=$(this).data("eid");$.post(a,{id:b},function(a){$("#"+a.responseText.formId);for(var b in a.responseText.data)$("[name="+b+"]").val(a.responseText.data[b]),"password"==b&&$("[name="+b+"]").val("")})});jQuery.fancybox&&$("a._lbox").fancybox({transitionIn:"none",transitionOut:"none",titlePosition:"over"})});
function loginCheck(){return null===$.cookie("PHPSESSID")?(showModalMessage("Session expired","Your session is expired! Please, login again",function(){top.location.href=$("#website_url").val()}),!1):!0}function showMessage(a,d,b){d?smoke.alert(a,{classname:"errors"}):(smoke.signal(a),b="undefined"==typeof b?1300:b,$(".smoke-base").delay(b).slideUp())}
function showConfirm(a,d,b){smoke.confirm(a,function(a){a?"undefined"!=typeof d&&d():"undefined"!=typeof b&&b()},{classname:"errors",ok:"Yes",cancel:"No"})}function showSpinner(){smoke.signal('<img src="'+$("#website_url").val()+'system/images/loading.gif" alt="working..." />',3E4)}function hideSpinner(){$(".smoke-base").hide()}function publishPages(){top.$("#__tpopup").length||$.get($("#website_url").val()+"backend/backend_page/publishpages/")}
function closePopup(a){a.contents().find("div.seotoaster").hasClass("refreshOnClose")&&window.parent.location.reload();"undefined"!=typeof a.dialog?a.dialog("close"):console.log("Alarm! Something went wrong!")}function generateStorageKey(){if($("#frm_content").length){var a=$("#frm_content").prop("action").split("/");return a[5]+a[7]+("undefined"==typeof a[9]?$("#page_id").val():a[9])}return null}
function showMailMessageEdit(a,d){$.getJSON($("#website_url").val()+"backend/backend_config/mailmessage/",{trigger:a},function(a){$(c).remove();var c=$('<div class="msg-edit-screen"></div>').append($('<textarea id="trigger-msg"></textarea>').val(a.responseText).css({width:"555px",height:"155px",resizable:"none"}));$("#trigger-msg").val(a.responseText);c.dialog({modal:!0,title:"Edit mail message before sending",width:600,height:300,resizable:!1,show:"clip",hide:"clip",draggable:!1,buttons:[{text:"Okay",
    click:function(a){c.dialog("close");d($("#trigger-msg").val())}}]}).parent().css({background:"#DAE8ED"})},"json")};
