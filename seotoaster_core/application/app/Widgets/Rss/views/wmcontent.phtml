<div class="widget-control-img" id="rss-img"></div>
<form class="wmc-block" action="javascript:;" id="rss-widget-form" style="display: none;" method="post">

	<label class="nopad grid_12" for="feed-url"><?php echo $this->translate('Feed url'); ?></label>
	<input class="nopad grid_12" type="text" id="feed-url" value="" />

	<label class="nopad grid_6" for="feed-maxres"><?php echo $this->translate('Max. results'); ?></label>
	<input class="nopad grid_6" type="text" id="feed-maxres" value="<?php echo Widgets_Rss_Rss::RSS_RESULT_COUNT; ?>" />

	<label class="nopad grid_6" for="feed-maxch"><?php echo $this->translate('Max. chars.'); ?></label>
	<input class="nopad grid_6" type="text" id="feed-maxch" value="<?php echo Widgets_Rss_Rss::RSS_DESC_LENGTH; ?>" />

	<div class="grid_12"><input class="formsubmit" type="submit" id="feed-done" name="done" value="Done" /></div>
</form>

<script type="text/javascript">
	$(function() {
		$('.widget-control-img#rss-img').click(function() {
			$('#widgets-header').text('<?php echo $this->translate('Rss feed'); ?>').fadeIn();
			$('#widget-controls').html($('#rss-widget-form').html());
			//$('#rss-widget-form').slideDown();
		});
		$('#feed-url').live('click', function() {$(this).removeClass('wmc-error');});
		$('#feed-done').live('click', function() {
			var feedUrl = $('#feed-url').val();
			if(!feedUrl) {
				$('#feed-url').toggleClass('wmc-error');
				return;
			}
			var rssWidget = '{$rss:' + feedUrl + ':' + $('#feed-maxres').val() + ':' + $('#feed-maxch').val() + '}';
			$('textarea.tinymce').tinymce().execCommand('mceInsertContent',false, rssWidget);
		})
	});
</script>