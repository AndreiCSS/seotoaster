<div class="header" style="overflow:hidden;"><?php echo $this->translate('Templates list'); ?>
	<div id="filters" class="tpllistfilter">
		<a href="javascript:;" class="lnk-filter" id="<?php echo Application_Model_Models_Template::TYPE_REGULAR; ?>"><?php echo $this->translate('Regular page'); ?></a> |
		<a href="javascript:;" class="lnk-filter" id="<?php echo Application_Model_Models_Template::TYPE_PRODUCT; ?>"><?php echo $this->translate('Product page'); ?></a> |
		<a href="javascript:;" class="lnk-filter" id="<?php echo Application_Model_Models_Template::TYPE_LISTING; ?>"><?php echo $this->translate('Product listing'); ?></a> |
		<a href="javascript:;" class="lnk-filter" id="<?php echo Application_Model_Models_Template::TYPE_MAIL; ?>regular"><?php echo $this->translate('E-mail sending'); ?></a> |
		<a href="javascript:;" class="lnk-filter" id="<?php echo Application_Model_Models_Template::TYPE_CHECKOUT; ?>"><?php echo $this->translate('Checkout page'); ?></a> |
		<a href="javascript:;" class="lnk-filter" id="all"><?php echo $this->translate('All'); ?></a>
<!--		<a href="javascript:;" class="lnk-filter" id="all">[ --><?php //echo $this->translate('Back'); ?><!-- ]</a>-->
	</div>
</div>
<script type="text/javascript">
	$(function(){
		$('#lnk-back').click(function(){
			$('#templatelist').slideUp();
		})
	})
</script>
<div style="overflow-y: scroll;" class="h520">
<?php foreach ($this->templates as $template) : ?>
<div class="grid_2 template_item <?php echo ((isset($template['isCurrent']) && $template['isCurrent']) ? 'curr-template' : ''); ?>" title="<?php echo sprintf($this->translate('%s template'), $template['fullName']); ?>">
	<div class="template_preview">
		<div style="height:220px;">
			<img src="<?php echo $this->websiteUrl.$template['preview_image']; ?>" alt="<?php echo $template['name']; ?>" style="z-index:1;width:125px;"/>
		</div>
		<div class="template_name">
			<?php echo Tools_Text_Tools::cutText($template['name'], 10); ?>
			<?php if (!in_array($template['name'], $this->protectedTemplates)): ?>
			<div class="template_delete"><img style="vertical-align:middle;" src="<?php echo $this->websiteUrl;?>/system/images/delete.png" alt="<?php echo $this->translate('Delete');?>" /></div>
			<?php endif; ?>
		</div>
		<?php echo $this->formHidden('template-id', $template['name'], array('id' => 'template-id-'.$template['name'])); ?>
	</div>
</div>
<?php endforeach; ?>
</div>

<script type="text/javascript">
	(function($){
		$('.lnk-filter').click(function() {
			var tplType = $(this).attr('id');
			$.post(
				$('#website_url').val()+'backend/backend_theme/gettemplate/',
				{'listtemplates':tplType, 'pageId' : $('#pageId').val()},
				function(response) {
					try {
						responseObject = $.parseJSON(response);
						$('.h520').html('Oops, ' + responseObject.responseText + '. Looks like you do not have any template of this type');
					}
					catch(err) {
						$('#templatelist').html(response);
					}
				}
			);
		})
	})(jQuery);
</script>